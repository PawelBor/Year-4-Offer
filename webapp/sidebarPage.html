<!DOCTYPE html>
<html lang="en">
	<head>
		<title>iOffer</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="css/sidebar.css">
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	</head>
	<body>
		<div id="wrapper">
			<!-- SIDEBAR-->
			<div id="sidebar-wrapper">
				<ul class="sidebar-nav">
					<li> <img class="userPicture"/> </li>
					<li><a href="#">Cars & Motor</a></li>
					<li><a href="#">Electronics</a></li>
					<li><a href="#">Food</a></li>
					<li><a href="#">Leisure</a></li>
					<li><a href="#">Entertainment</a></li>
					<li><a href="#">Other</a></li>
				</ul>
			</div>
			<!--Page content-->
			<div id="page-content-wrapper">
				<div class="container-fluid">
					<div class="row">
						<div class="col-lg-12">
							<a href="#" class="btn btn-success" id="menu-toggle">Toggle Menu</a>
							<h1>Welcome to iOffer</h1>
							<p>"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p>
                                                        <a href="search.jsp">Results</a>
                                                        <div class = "panel panel-default">
								<div class = "panel-heading">
									<h3 class = "panel-title">Your Listed Ads:</h3>
								</div>
								<table class = "table">
									<tr>
										<th>Product</th>
										<th>Price </th>
									</tr>
									<tr>
										<td>OEMS 19" 5x112 (SET)</td>
										<td>600</td>
									</tr>
									<tr>
										<td>SPORTIVA MILANO 18" 5x112</td>
										<td>350</td>
									</tr>
								</table>
							</div>
                                                        
        <div>
            <div class="form-group">
                <input type="text" class="form-control" id="prodName" name="name" required="" placeholder="Name">
                <input type="text" class="form-control" id="prodDescription" name="description" required="" placeholder="Description">
                <input type="text" class="form-control" id="prodPrice" name="price" required="" placeholder="Price">
                <input type="text" class="form-control" id="prodLocation" name="location" required="" placeholder="Location">
                <input type="text" class="form-control" id="prodCategory" name="category" required="" placeholder="Category">
                <input type="file" accept=".jpg,.jpeg,.png" id="images" name="image" multiple />
                <output id="list"></output>
                <button id="postButton" value="Submit" name="send"></button>
            </div>
            <button class="btn btn-lg btn-success" id="locationbtn">Get location</button>
        </div>
                                                       
                 <!-- https://www.html5rocks.com/en/tutorials/file/dndfiles/ -->                                       
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--Menu toggle -->
		<script>
                    $("#menu-toggle").click(function (e){
                    e.preventDefault(); //<!-- preveent default action - dont go to a link-->
                    $("#wrapper").toggleClass("menuDisplayed"); //<!-- adds/rem,oves toggle class-->
                    });
                    
                    $("#postButton").click(function(e){
          	    	  	var name = $("#prodName").val();
	          	  		var description = $("#prodDescription").val();
	          	  		var price = $("#prodPrice").val();
	          	  		var location = $("#prodLocation").val();
	          	  		var category = $("#prodCategory").val();
	          	  		var images = $("#images").val();
          	    	  	
	          	  		$.ajax({
	          	  			url: '/webapi/product',
	          	  			type: 'POST',
	          	  			data: {name: name, description: description, price : price, location: location, category: category, images: images, county: "Gaillimh", author: "Baldwan"},
	          	  			contentType: 'multipart/form-data',
	          	  			success: function(response){
	          	  				console.log(response)
	          	  				if(response != null){
	          	  					window.location.assign("/webapi/product/" + response);
	          	  		        }else{
	          	  		        	// TELL USER THAT DETAILS ARE INCORRECT
	          	  		        	console.log("Putting into db failed");
	          	  		        }
	          	  		    }
	          	  		});
	          	  	});

                    function handleFileSelect(evt) {
                        for (var i = 0, f; f = evt.target.files[i]; i++){
                            var output = '<img width="150" "height="100" src="' + URL.createObjectURL(f) + '">';
                            document.getElementById('list').innerHTML += output;
                        }
                    }

                    document.getElementById('images').addEventListener('change', handleFileSelect, false);
					
					function loc(position) {
                		var location = {
                			latitude: null,
                			longitude: null
                		};
                    	
                    	location.latitude  = position.coords.latitude;
                		location.longitude = position.coords.longitude;
                		console.log(location.latitude + ' '  + location.longitude);
                		
                		return location;
                	  }
					  
					  $("#locationbtn").click(function (e){
                    	navigator.geolocation.getCurrentPosition(loc);
                    });
		</script>
	</body>
</html>